<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>Document</title>
</head>
<body>
    <form>
        enter site id<input type="text" id="site_id" >
        enter date<input type="date" id="da">
        <br>
        <input type="button" id="bb1" value="submit"><br><br>
        <div id="t_volume"></div>
        <div id="dis_brick"></div>
        <div id="dis_plaster"></div>
        <div id="dis_paint"></div>
        <div id="dis_concrete"></div>
    </form>


    <form style="display:none" id="form2">
        Total volume of brick
        <input type="number" id="v_brick" placeholder="wages for brick">
        <input type="number" id="w_brick">     <br>
        Total volume of plaster
        <input type="number" id="v_plaster" placeholder="wages for plaster">
        <input type="number" id="w_plaster">     <br>
        Total volume of paint
        <input type="number" id="v_paint" placeholder="wages for paint">
        <input type="number" id="w_paint">     <br>
        Total volume of concrte
        <input type="number" id="v_concrete" placeholder="wages for concrete">
        <input type="number" id="w_concrete">     <br>
        <input type="button" id="b_wages"  value="calculate total wages">

    </form>


    <script>
        const butt=document.getElementById("bb1");
        let t_volume_brick=0,t_volume_concrete=0,t_volume_plaster=0,t_volume_paint=0;
        butt.addEventListener('click',async()=>{

    


            
            let site_id=document.getElementById("site_id").value;
            let da=document.getElementById("da").value;
            // alert(site_id);
            // // var d=JSON.stringify({site_id:site_id,date:da});
            // alert(da);

            //brick

           await fetch('http://localhost:3010/get_brick/'+site_id+'/'+da)
           .then(async(e)=>{
            return e.json();
           })
           .then(async(e1)=>{
            let temp="<div class='row'>Brick work";
            
            for(let d of e1){
                temp+="<div class='col-sm-3'><div class='card'><p>Site ID "+d.site_id+"</p>";
                temp+="<p>length "+d.length+"</p>";
                temp+="<p>Breadth "+d.breadth+"</p>";
                temp+="<p>Height "+d.height+"</p>";
                temp+="<p>Nos "+d.nos+"</p>";
                temp+="<p>Volume "+d.volume+"</p></div></div>";
                t_volume_brick+=d.volume;
            }
            temp+="</div>";
            document.getElementById("dis_brick").innerHTML=temp;
           })
           .catch(async(err)=>
           alert("error"+err));


           //plastering
           await fetch('http://localhost:3010/get_plaster/'+site_id+'/'+da)
           .then(async(e)=>{
            return e.json();
           })
           .then(async(e1)=>{
           
            let temp="<div class='row'>plastering";
            for(let d of e1){
                temp+="<div class='col-sm-3'><div class='card'><p>Site ID "+d.site_id+"</p>";
                temp+="<p>length "+d.length+"</p>";
                temp+="<p>Breadth "+d.breadth+"</p>";
               
                temp+="<p>Nos "+d.nos+"</p>";
                temp+="<p>Volume "+d.volume+"</p></div></div>";

                t_volume_plaster+=d.volume;
            }
            temp+="</div>";
            temp+="</div>";
            document.getElementById("dis_plaster").innerHTML=temp;
           })
           .catch(async(err)=>
           alert("error_plaster"+err));


        //paint

        await fetch('http://localhost:3010/get_paint/'+site_id+'/'+da)
           .then(async(e)=>{
            return e.json();
           })
           .then(async(e1)=>{
        
            let temp="<div class='row'>paint";
            for(let d of e1){
                temp+="<div class='col-sm-3'><div class='card'><p>Site ID "+d.site_id+"</p>";
                temp+="<p>length "+d.length+"</p>";
                temp+="<p>Breadth "+d.breadth+"</p>";
              
                temp+="<p>Nos "+d.nos+"</p>";
                temp+="<p>Volume "+d.volume+"</p></div></div>";
                t_volume_paint+=d.volume;
            }
            temp+="</div>";
            temp+="</div>";
            document.getElementById("dis_paint").innerHTML=temp;
           })
           .catch(async(err)=>
           alert("error_paint"+err));


        //concrete

        await fetch('http://localhost:3010/get_concrete/'+site_id+'/'+da)
           .then(async(e)=>{
            return e.json();
           })
           .then(async(e1)=>{
          
            let temp="<div class='row'>Concrete";
            for(let d of e1){
                temp+="<div class='col-sm-3'><div class='card'><p>Site ID "+d.site_id+"</p>";
                temp+="<p>length "+d.length+"</p>";
                temp+="<p>Breadth "+d.breadth+"</p>";
                temp+="<p>Height "+d.height+"</p>";
                temp+="<p>Nos "+d.nos+"</p>";
                temp+="<p>Volume "+d.volume+"</p></div></div>";

                t_volume_concrete+=d.volume;
            }
            temp+="</div>";

            
            document.getElementById("dis_concrete").innerHTML=temp;

          document.getElementById("v_brick").value=t_volume_brick;
          document.getElementById("v_plaster").value=t_volume_plaster;
          document.getElementById("v_paint").value=t_volume_paint;
          document.getElementById("v_concrete").value=t_volume_concrete;




// document.getElementById("t_volume").innerHTML=t;
document.getElementById("form2").style.display="block";


           })
           .catch(async(err)=>
           alert("error_concrete"+err));


           



        })

        const b_wages=document.getElementById("b_wages");

        b_wages.addEventListener('click',async()=>{

            
            let site_id=(document.getElementById("site_id").value);
            let da=(document.getElementById("da").value);

            let v_brick=Number(document.getElementById("v_brick").value);
            let v_paint=Number(document.getElementById("v_paint").value);
            let v_concrete=Number(document.getElementById("v_concrete").value);
            let v_plaster=Number(document.getElementById("v_plaster").value);
    
            // let w_brick=Number(document.getElementById("w_brick").value);
            // let w_paint=Number(document.getElementById("w_paint").value);
            // let w_concrete=Number(document.getElementById("w_concrete").value);
            // let w_plaster=Number(document.getElementById("w_plaster").value);
          

        let w1=Number(document.getElementById("w_brick").value);
        let w2=Number(document.getElementById("w_plaster").value);
        let w3=Number(document.getElementById("w_paint").value);
        let w4=Number(document.getElementById("w_concrete").value);
alert("Df");
let t_brick=(w1*v_brick);
let t_paint=(w3*v_paint);
let t_concrete=(w4*v_concrete);
let t_plaster=(w2*v_plaster);
         let total_amount=(t_brick+t_concrete+t_paint+t_plaster);

        alert(total_amount);
        var d=JSON.stringify({site_id:site_id,date:da,v_brick:v_brick,v_paint,v_paint,v_concrete:v_concrete,v_plaster:v_plaster,w_brick:w1,w_concrete:w4,w_plaster:w2,w_paint:w3,t_brick:t_brick,t_paint:t_paint,t_concrete:t_concrete,t_plaster:t_plaster,t_wages:total_amount});


            alert(d);


           






            await fetch('http://localhost:3010/insert_wages',{

                mode:'cors',
                method:'POST',
                headers:{
                    'Content-Type':'application/JSON'
                },
                body:d


            })
            .then(async(e)=>{
                return e.json();
            })
            .then(async(e1)=>{
                alert("inserted total wages");
            })
            .catch(async(err)=>{
                alert("error occure _inserting "+err);
            })

            
        })


    </script>
</body>
</html>